<!DOCTYPE html>
<html >
	<head>
		<!-- TocasUI -->
		<link rel="stylesheet" href="http://cdn.rawgit.com/TeaMeow/TocasUI/master/dist/tocas.min.css">
		
		<meta charset="UTF-8">
		<title>Login/Sign-In</title>
		<meta content="text/html; charset=Big5" http-equiv="'application/json'">
		
		<link rel="stylesheet" href="css/normalize.css">
		
		<link rel='stylesheet prefetch' href='http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css'>
		
		<link rel="stylesheet" href="css/loginstyle.css">
		
		<!--<script type="text/javascript" src="json2.js"></script>-->
		
		<script src="js/jquery.min.js" type="text/javascript"></script>
		<script src="js/sha512.js" type="text/javascript"></script>
		
	</head>
	
	<body>
		<div class="ts primary raised jumbotron" id="infor" style="z-index: 100">
			<h2 class="ts header" id="infor-title">Title
				<div class="sub header" id="infor-infor">infor</div>
			</h2>
		</div>
		<div class="logmod">
			<div class="logmod__wrapper">
				<span class="logmod__close">關閉</span>
				<div class="logmod__container">
					<ul class="logmod__tabs">
						<li data-tabtar="lgm-2"><a href="#">登入</a></li>
						<li data-tabtar="lgm-1"><a href="#">註冊</a></li>
					</ul>
					<div class="logmod__tab-wrapper">
						<div class="logmod__tab lgm-1">
							<div class="logmod__heading">
								<span class="logmod__heading-subtitle">輸入您的資料 <strong>來註冊一個帳戶</strong></span>
							</div>
							<div class="logmod__form">
								<form accept-charset="utf-8" action="#" class="simform">
									<div class="sminputs">
										<div class="input full">
											<label class="string optional" for="user-name">Email*</label>
											<input class="string optional" maxlength="255" id="user-email" method="post" action="" placeholder="Email" type="email" size="50" />
										</div>
									</div>
									<var></var>
									<div class="sminputs">
										<div class="input full">
											<label class="string optional" for="nickname">暱稱*</label>
											<input class="string optional" maxlength="255" id="nickname" method="post" action="" placeholder="nickname" type="nickname" size="50" />
										</div>
									</div>
									<div class="sminputs">
										<div class="input string optional">
											<label class="string optional" for="user-pw">密碼 *</label>
											<input class="string optional" maxlength="255" id="user-pw" method="post" action="" placeholder="Password" type="text" size="50" />
											
										</div>
										<div class="input string optional">
											<label class="string optional" for="user-pw-repeat">重複輸入密碼 *</label>
											<input class="string optional" maxlength="255" id="user-pw-repeat" method="post" action="" placeholder="Repeat password" type="text" size="50" />
										</div>
									</div>
									<div class="simform__actions">
										<nav id="nav">
											<input class="sumbit" name="commit" type="sumbit" id="sign-up"value="註冊帳戶" />
										</nav>
										
										<!--<span class="simform__actions-sidetext">在註冊之前請先同意我們的 <a class="special" href="#" target="_blank" role="link">隱私與使用條款</a></span>-->
									</div> 
								</form>
							</div>
							<!--
								<div class="logmod__alter">
								<div class="logmod__alter-container">
								<a href="#" class="connect facebook">
								<div class="connect__icon">
								<i class="fa fa-facebook"></i>
								</div>
								<div class="connect__context">
								<span>以 <strong>Facebook</strong>註冊帳戶</span>
								</div>
								</a>
								
								<a href="#" class="connect googleplus">
								<div class="connect__icon">
								<i class="fa fa-google-plus"></i>
								</div>
								<div class="connect__context">
								<span>以 <strong>Google+</strong>註冊帳戶</span>
								</div>
								</a>
								</div>
								</div>
							-->
						</div>
						<div class="logmod__tab lgm-2">
							<div class="logmod__heading">
								<span class="logmod__heading-subtitle">輸入您的Email和密碼 <strong>來登入</strong></span>
							</div> 
							<div class="logmod__form">
								<form accept-charset="utf-8" action="#" class="simform">
									<div class="sminputs">
										<div class="input full">
											<label class="string optional" for="user-name">Email*</label>
											<input class="string optional" maxlength="255" id="user-emailx" placeholder="Email" type="email" size="50" onload="user-mail">
										</div>
									</div>
									<div class="sminputs">
										<div class="input full">
											<label class="string optional" for="user-pw">密碼 *</label>
											<input class="string optional" maxlength="255" id="user-pwx" placeholder="Password" type="password" size="50" />
											<span class="hide-password">Show</span>
										</div>
									</div>
									<div class="simform__actions">
										<ul class="actions">
											<li><a href="../main-single.html" class="button special"><input class="sumbit" name="commit" type="sumbit" value="登入"   /></a>
											</li>
											
											<!-- <li><a href="main-single.html" class="button special"></a> </li> 
											</ul></nav>-->  
											
											<!--
												
											<span class="simform__actions-sidetext"><a class="special" role="link" href="../user/forgotpw.html">忘記密碼?<br>請點這裡</a></span>-->
										</div> 
									</form>
								</div>
								<!--
									<div class="logmod__alter">
									<div class="logmod__alter-container">
									<a href="#" class="connect facebook">
									<div class="connect__icon">
									<i class="fa fa-facebook"></i>
									</div>
									<div class="connect__context">
									<span>使用 <strong>Facebook</strong>登入</span>
									</div>
									</a>
									<a href="#" class="connect googleplus">
									<div class="connect__icon">
									<i class="fa fa-google-plus"></i>
									</div>
									<div class="connect__context">
									<span>使用 <strong>Google+</strong>登入</span>
									</div>
									</a>
									</div>
									</div>
								-->
							</div>
						</div>
					</div>
				</div>
			</div>
			
			<script src='http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
			
			<script src="js/index.js"></script>
			
			<script type="text/javascript">
				var domain = "xueba.entresoft.org";
				function login(){
					var userpw=$("#user-pw").val();
					userpw = CryptoJS.SHA512(userpw);
					var user_email=$("#user-email").val();
					$.ajax({
						type: "POST", 
						url: domain+"/login", 
						dataType: "json", 
						data: {"email":user_email, "password": userpw},
						success: function(res){
							if(!res['message'])
							alert_animation('!', '登入成功');
						},
						error: function(xhr){
							console.log('login error');
						}
					})
				}
				function register(){
					var userpw=$("#user-pw").val();
					var nickname=$("#nickname").val();
					var user_email=$("#user-email").val();
					var user_pw_repeat=$("#user-pw-repeat").val();
					if(userpw!=user_pw_repeat){
						alert_animation("密碼輸入錯誤");
					}
					userpw = CryptoJS.SHA512(userpw);
					$.ajax({
						type: 'POST',
						url: domain+'/register',
						dataType: 'json',
						data: {email: user_email, password: userpw, nickname: nickname},
						error: function(xhr){
							console.log('register error');
						},
						success: function(res){
							if(!res['message']){
								alert_animation('!', '註冊成功');
							}
						}
					})
				}
				function alert_animation(title, msg){
					$('#infor-title').html(title+'<div class="sub header" id="infor-infor">infor</div>')
					$('#infor-infor').text(msg)
					$('#infor').show()
					setTimeout(function(){
						$('#infor').hide();
					} ,5000)
				}
				function addonloadevent(f){
					var old = window.onload;
					if(typeof window.onload !== 'function'){
						window.onload = f;
						}else{
						window.onload = function(){
							if(old){
								old();
							}
							f();
						}
					}
				}
				addonloadevent(function(){
					$('#infor').hide();
				})
			</script>
			
		</body>
	</html>
