var regist = require('regist');
var Db = require('Database')

module.exports = function(req, callback){
  //regist.key.forEach(function(element){i
	for(var k in regist.key){
		var element = regist.key[k];
    if(element['token']===req.cookies.token && element['ip']===req.connection.remoteAddress){
      var cursor = Db.db.collection('users').find({email: element['email']});
      cursor.toArray(function(err, docs){
        if(err){
					console.log(err);
					callback(false)
					return;
				}
				if(docs.length===0){
					callback(false)
					return;
				}
				callback(true)
      });
			break;
    }
	}
	callback(false)
  //});
}
